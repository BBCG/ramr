<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate a set of aberrantly methylated regions — simulateAMR • ramr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate a set of aberrantly methylated regions — simulateAMR" />
<meta property="og:description" content="`simulateAMR` returns a `GRanges` object containing a set of randomly
selected aberrantly methylated regions (AMRs) to be used as an input for the
`simulateData` method." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ramr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/ramr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/BBCG/ramr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate a set of aberrantly methylated regions</h1>
    <small class="dont-index">Source: <a href='https://github.com/BBCG/ramr/blob/master/R/simulateAMR.R'><code>R/simulateAMR.R</code></a></small>
    <div class="hidden name"><code>simulateAMR.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>`simulateAMR` returns a `GRanges` object containing a set of randomly
selected aberrantly methylated regions (AMRs) to be used as an input for the
`simulateData` method.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>simulateAMR</span><span class='op'>(</span>
  <span class='va'>template.ranges</span>,
  <span class='va'>nsamples</span>,
  exclude.ranges <span class='op'>=</span> <span class='cn'>NULL</span>,
  regions.per.sample <span class='op'>=</span> <span class='fl'>1</span>,
  samples.per.region <span class='op'>=</span> <span class='fl'>1</span>,
  sample.names <span class='op'>=</span> <span class='cn'>NULL</span>,
  merge.window <span class='op'>=</span> <span class='fl'>300</span>,
  min.cpgs <span class='op'>=</span> <span class='fl'>7</span>,
  max.cpgs <span class='op'>=</span> <span class='cn'>Inf</span>,
  min.width <span class='op'>=</span> <span class='fl'>1</span>,
  dbeta <span class='op'>=</span> <span class='fl'>0.25</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>template.ranges</th>
      <td><p>A `GRanges` object with genomic locations (same object
must be supplied to this and to the `simulateData` functions).</p></td>
    </tr>
    <tr>
      <th>nsamples</th>
      <td><p>A single integer &gt;= 1 indicating the number of samples to
which AMRs will be assigned.</p></td>
    </tr>
    <tr>
      <th>exclude.ranges</th>
      <td><p>A `GRanges` object with genomic locations. None of the
simulated AMRs in the output will overlap with any of regions from
`exclude.ranges`. If `NULL` (the default), AMRs are not restricted by their
genomic location.</p></td>
    </tr>
    <tr>
      <th>regions.per.sample</th>
      <td><p>A single integer &gt;= 1 (the default). Number of AMRs
to be assigned to every sample. Message is shown and the `regions.per.sample`
value is limited to `maxnAMR <!-- %/% nsamples` if it is greater than this number -->
(where `maxnAMR` is the maximum number of potential AMRs for the
`template.ranges`).</p></td>
    </tr>
    <tr>
      <th>samples.per.region</th>
      <td><p>A single integer &gt;= 1 (the default). Number of
samples to which the same AMR will be assigned. Message is shown and the
`samples.per.region` value is limited to `nsamples` if the former is greater
than the latter.</p></td>
    </tr>
    <tr>
      <th>sample.names</th>
      <td><p>A character vector with sample names. If `NULL` (the
default), sample names will be computed as
`paste0("sample", seq_len(nsamples))`. When specified, the length of the
`sample.names` vector must not be smaller than the value of `nsamples`.</p></td>
    </tr>
    <tr>
      <th>merge.window</th>
      <td><p>A positive integer. All `template.ranges` genomic
locations within this distance will be merged to create a list of potential
AMRs (which will be later filtered from regions overlapping with any regions
from the `exclude.ranges`).</p></td>
    </tr>
    <tr>
      <th>min.cpgs</th>
      <td><p>A single integer &gt;= 1. All AMRs containing less than
`min.cpgs` genomic locations are filtered out. The default: 7.</p></td>
    </tr>
    <tr>
      <th>max.cpgs</th>
      <td><p>A single integer &gt;= 1. All AMRs containing more than
`max.cpgs` genomic locations are filtered out. The default: `Inf`.</p></td>
    </tr>
    <tr>
      <th>min.width</th>
      <td><p>A single integer &gt;= 1 (the default). Only AMRs with the
width of at least `min.width` are returned.</p></td>
    </tr>
    <tr>
      <th>dbeta</th>
      <td><p>A single non-negative numeric value in the range [0,1] or a
numeric vector of such values (with as many elements as there are AMRs).
Used to populate the `dbeta` metadata column, defines a desired absolute
deviation of corresponding AMR from the median for the `simulateData`
function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The output is a `GRanges` object that contains a subset of
aberrantly methylated regions (AMRs) randomly selected from all the possible
AMRs for the provided `template.ranges` object. The following metadata
columns are included:</p><ul>
<li><p>`revmap` -- integer list of `template.ranges` genomic locations that
  are included in this AMR region</p></li>
<li><p>`ncpg` -- number of `template.ranges` genomic locations within
  this AMR region</p></li>
<li><p>`sample` -- an identifier of a sample to which
  corresponding AMR belongs</p></li>
<li><p>`dbeta` -- equals to supplied `dbeta` parameter</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Using provided template (`GRanges` object) `simulateAMR` randomly selects
genomic regions satisfying various criteria (number of CpGs, width of the
region) and assigns them to samples according to specified parameters
(number of AMRs per sample, number of samples per AMR). Its output is meant
to be used as the set of true positive AMRs for the `simulateData` function.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='simulateData.html'>simulateData</a></code> for the generation of simulated test
data sets, <code><a href='getAMR.html'>getAMR</a></code> for identification of AMRs,
<code><a href='plotAMR.html'>plotAMR</a></code> for plotting AMRs, <code><a href='getUniverse.html'>getUniverse</a></code>
for info on enrichment analysis, and `ramr` vignettes for the description of
usage and sample data.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'>  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>ramr</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='va'>amrs.unique</span> <span class='op'>&lt;-</span></span>
<span class='r-in'>    <span class='fu'>simulateAMR</span><span class='op'>(</span><span class='va'>ramr.data</span>, nsamples<span class='op'>=</span><span class='fl'>4</span>, regions.per.sample<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                min.cpgs<span class='op'>=</span><span class='fl'>5</span>, merge.window<span class='op'>=</span><span class='fl'>1000</span>, dbeta<span class='op'>=</span><span class='fl'>0.2</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='va'>amrs.nonunique</span> <span class='op'>&lt;-</span></span>
<span class='r-in'>    <span class='fu'>simulateAMR</span><span class='op'>(</span><span class='va'>ramr.data</span>, nsamples<span class='op'>=</span><span class='fl'>3</span>, exclude.ranges<span class='op'>=</span><span class='va'>amrs.unique</span>,</span>
<span class='r-in'>                samples.per.region<span class='op'>=</span><span class='fl'>2</span>, min.cpgs<span class='op'>=</span><span class='fl'>5</span>, merge.window<span class='op'>=</span><span class='fl'>1000</span><span class='op'>)</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Oleksii Nikolaienko.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


